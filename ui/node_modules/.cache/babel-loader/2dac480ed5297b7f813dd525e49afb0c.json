{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InMemoryLRUCache = void 0;\n\nconst lru_cache_1 = __importDefault(require(\"lru-cache\"));\n\nfunction defaultLengthCalculation(item) {\n  if (Array.isArray(item) || typeof item === 'string') {\n    return item.length;\n  }\n\n  return 1;\n}\n\nclass InMemoryLRUCache {\n  constructor() {\n    let {\n      maxSize = Infinity,\n      sizeCalculator = defaultLengthCalculation,\n      onDispose\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.store = new lru_cache_1.default({\n      max: maxSize,\n      length: sizeCalculator,\n      dispose: onDispose\n    });\n  }\n\n  async get(key) {\n    return this.store.get(key);\n  }\n\n  async set(key, value, options) {\n    const maxAge = (options === null || options === void 0 ? void 0 : options.ttl) && options.ttl * 1000;\n    this.store.set(key, value, maxAge);\n  }\n\n  async delete(key) {\n    this.store.del(key);\n  }\n\n  async flush() {\n    this.store.reset();\n  }\n\n  async getTotalSize() {\n    return this.store.length;\n  }\n\n  static jsonBytesSizeCalculator(obj) {\n    return Buffer.byteLength(JSON.stringify(obj), 'utf8');\n  }\n\n}\n\nexports.InMemoryLRUCache = InMemoryLRUCache;","map":{"version":3,"sources":["../src/InMemoryLRUCache.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAAA,MAAA,WAAA,GAAA,eAAA,CAAA,OAAA,CAAA,WAAA,CAAA,CAAA;;AAGA,SAAS,wBAAT,CAAkC,IAAlC,EAA2C;AACzC,MAAI,KAAK,CAAC,OAAN,CAAc,IAAd,KAAuB,OAAO,IAAP,KAAgB,QAA3C,EAAqD;AACnD,WAAO,IAAI,CAAC,MAAZ;AACD;;AAID,SAAO,CAAP;AACD;;AAED,MAAa,gBAAb,CAA6B;AAI3B,EAAA,WAAA,GAQM;AAAA,QARM;AACV,MAAA,OAAO,GAAG,QADA;AAEV,MAAA,cAAc,GAAG,wBAFP;AAGV,MAAA;AAHU,KAQN,uEAAF,EAAE;AACJ,SAAK,KAAL,GAAa,IAAI,WAAA,CAAA,OAAJ,CAAa;AACxB,MAAA,GAAG,EAAE,OADmB;AAExB,MAAA,MAAM,EAAE,cAFgB;AAGxB,MAAA,OAAO,EAAE;AAHe,KAAb,CAAb;AAKD;;AAEQ,QAAH,GAAG,CAAC,GAAD,EAAY;AACnB,WAAO,KAAK,KAAL,CAAW,GAAX,CAAe,GAAf,CAAP;AACD;;AACQ,QAAH,GAAG,CAAC,GAAD,EAAc,KAAd,EAAwB,OAAxB,EAAkD;AACzD,UAAM,MAAM,GAAG,CAAA,OAAO,KAAA,IAAP,IAAA,OAAO,KAAA,KAAA,CAAP,GAAO,KAAA,CAAP,GAAA,OAAO,CAAE,GAAT,KAAgB,OAAO,CAAC,GAAR,GAAc,IAA7C;AACA,SAAK,KAAL,CAAW,GAAX,CAAe,GAAf,EAAoB,KAApB,EAA2B,MAA3B;AACD;;AACW,QAAN,MAAM,CAAC,GAAD,EAAY;AACtB,SAAK,KAAL,CAAW,GAAX,CAAe,GAAf;AACD;;AAIU,QAAL,KAAK,GAAA;AACT,SAAK,KAAL,CAAW,KAAX;AACD;;AACiB,QAAZ,YAAY,GAAA;AAChB,WAAO,KAAK,KAAL,CAAW,MAAlB;AACD;;AAK6B,SAAvB,uBAAuB,CAAI,GAAJ,EAAU;AACtC,WAAO,MAAM,CAAC,UAAP,CAAkB,IAAI,CAAC,SAAL,CAAe,GAAf,CAAlB,EAAuC,MAAvC,CAAP;AACD;;AA7C0B;;AAA7B,OAAA,CAAA,gBAAA,GAAA,gBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InMemoryLRUCache = void 0;\nconst lru_cache_1 = __importDefault(require(\"lru-cache\"));\nfunction defaultLengthCalculation(item) {\n    if (Array.isArray(item) || typeof item === 'string') {\n        return item.length;\n    }\n    return 1;\n}\nclass InMemoryLRUCache {\n    constructor({ maxSize = Infinity, sizeCalculator = defaultLengthCalculation, onDispose, } = {}) {\n        this.store = new lru_cache_1.default({\n            max: maxSize,\n            length: sizeCalculator,\n            dispose: onDispose,\n        });\n    }\n    async get(key) {\n        return this.store.get(key);\n    }\n    async set(key, value, options) {\n        const maxAge = (options === null || options === void 0 ? void 0 : options.ttl) && options.ttl * 1000;\n        this.store.set(key, value, maxAge);\n    }\n    async delete(key) {\n        this.store.del(key);\n    }\n    async flush() {\n        this.store.reset();\n    }\n    async getTotalSize() {\n        return this.store.length;\n    }\n    static jsonBytesSizeCalculator(obj) {\n        return Buffer.byteLength(JSON.stringify(obj), 'utf8');\n    }\n}\nexports.InMemoryLRUCache = InMemoryLRUCache;\n//# sourceMappingURL=InMemoryLRUCache.js.map"]},"metadata":{},"sourceType":"script"}