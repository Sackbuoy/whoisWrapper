{"ast":null,"code":"'use strict';\n\nconst assert = require('assert');\n\nconst {\n  kDestroyed,\n  kBodyUsed\n} = require('./symbols');\n\nconst {\n  IncomingMessage\n} = require('http');\n\nconst stream = require('stream');\n\nconst net = require('net');\n\nconst {\n  InvalidArgumentError\n} = require('./errors');\n\nconst {\n  Blob\n} = require('buffer');\n\nfunction nop() {}\n\nfunction isStream(obj) {\n  return obj && typeof obj.pipe === 'function';\n}\n\nfunction isBlob(obj) {\n  return obj && Blob && obj instanceof Blob;\n}\n\nfunction parseURL(url) {\n  if (typeof url === 'string') {\n    url = new URL(url);\n  }\n\n  if (!url || typeof url !== 'object') {\n    throw new InvalidArgumentError('invalid url');\n  }\n\n  if (url.port != null && url.port !== '' && !Number.isFinite(parseInt(url.port))) {\n    throw new InvalidArgumentError('invalid port');\n  }\n\n  if (url.path != null && typeof url.path !== 'string') {\n    throw new InvalidArgumentError('invalid path');\n  }\n\n  if (url.pathname != null && typeof url.pathname !== 'string') {\n    throw new InvalidArgumentError('invalid pathname');\n  }\n\n  if (url.hostname != null && typeof url.hostname !== 'string') {\n    throw new InvalidArgumentError('invalid hostname');\n  }\n\n  if (url.origin != null && typeof url.origin !== 'string') {\n    throw new InvalidArgumentError('invalid origin');\n  }\n\n  if (!/^https?:/.test(url.origin || url.protocol)) {\n    throw new InvalidArgumentError('invalid protocol');\n  }\n\n  if (!(url instanceof URL)) {\n    const port = url.port != null ? url.port : url.protocol === 'https:' ? 443 : 80;\n    const origin = url.origin != null ? url.origin : `${url.protocol}//${url.hostname}:${port}`;\n    const path = url.path != null ? url.path : `${url.pathname || ''}${url.search || ''}`;\n    url = new URL(path, origin);\n  }\n\n  return url;\n}\n\nfunction parseOrigin(url) {\n  url = parseURL(url);\n\n  if (url.pathname !== '/' || url.search || url.hash) {\n    throw new InvalidArgumentError('invalid url');\n  }\n\n  return url;\n}\n\nfunction getHostname(host) {\n  if (host[0] === '[') {\n    const idx = host.indexOf(']');\n    assert(idx !== -1);\n    return host.substr(1, idx - 1);\n  }\n\n  const idx = host.indexOf(':');\n  if (idx === -1) return host;\n  return host.substr(0, idx);\n} // IP addresses are not valid server names per RFC6066\n// > Currently, the only server names supported are DNS hostnames\n\n\nfunction getServerName(host) {\n  if (!host) {\n    return null;\n  }\n\n  assert.strictEqual(typeof host, 'string');\n  const servername = getHostname(host);\n\n  if (net.isIP(servername)) {\n    return '';\n  }\n\n  return servername;\n}\n\nfunction deepClone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction isAsyncIterable(obj) {\n  return !!(obj != null && typeof obj[Symbol.asyncIterator] === 'function');\n}\n\nfunction isIterable(obj) {\n  return !!(obj != null && (typeof obj[Symbol.iterator] === 'function' || typeof obj[Symbol.asyncIterator] === 'function'));\n}\n\nfunction bodyLength(body) {\n  if (body == null) {\n    return 0;\n  } else if (isStream(body)) {\n    const state = body._readableState;\n    return state && state.ended === true && Number.isFinite(state.length) ? state.length : null;\n  } else if (isBlob(body)) {\n    return body.size;\n  } else if (isBuffer(body)) {\n    return body.byteLength;\n  }\n\n  return null;\n}\n\nfunction isDestroyed(stream) {\n  return !stream || !!(stream.destroyed || stream[kDestroyed]);\n}\n\nfunction isAborted(stream) {\n  const state = stream && stream._readableState;\n  return isDestroyed(stream) && state && !state.endEmitted;\n}\n\nfunction destroy(stream, err) {\n  if (!isStream(stream) || isDestroyed(stream)) {\n    return;\n  }\n\n  if (typeof stream.destroy === 'function') {\n    if (Object.getPrototypeOf(stream).constructor === IncomingMessage) {\n      // See: https://github.com/nodejs/node/pull/38505/files\n      stream.socket = null;\n    }\n\n    stream.destroy(err);\n  } else if (err) {\n    process.nextTick((stream, err) => {\n      stream.emit('error', err);\n    }, stream, err);\n  }\n\n  if (stream.destroyed !== true) {\n    stream[kDestroyed] = true;\n  }\n}\n\nconst KEEPALIVE_TIMEOUT_EXPR = /timeout=(\\d+)/;\n\nfunction parseKeepAliveTimeout(val) {\n  const m = val.toString().match(KEEPALIVE_TIMEOUT_EXPR);\n  return m ? parseInt(m[1], 10) * 1000 : null;\n}\n\nfunction parseHeaders(headers) {\n  let obj = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  for (let i = 0; i < headers.length; i += 2) {\n    const key = headers[i].toString().toLowerCase();\n    let val = obj[key];\n\n    if (!val) {\n      obj[key] = headers[i + 1].toString();\n    } else {\n      if (!Array.isArray(val)) {\n        val = [val];\n        obj[key] = val;\n      }\n\n      val.push(headers[i + 1].toString());\n    }\n  }\n\n  return obj;\n}\n\nfunction isBuffer(buffer) {\n  // See, https://github.com/mcollina/undici/pull/319\n  return buffer instanceof Uint8Array || Buffer.isBuffer(buffer);\n}\n\nfunction validateHandler(handler, method, upgrade) {\n  if (!handler || typeof handler !== 'object') {\n    throw new InvalidArgumentError('handler must be an object');\n  }\n\n  if (typeof handler.onConnect !== 'function') {\n    throw new InvalidArgumentError('invalid onConnect method');\n  }\n\n  if (typeof handler.onError !== 'function') {\n    throw new InvalidArgumentError('invalid onError method');\n  }\n\n  if (typeof handler.onBodySent !== 'function' && handler.onBodySent !== undefined) {\n    throw new InvalidArgumentError('invalid onBodySent method');\n  }\n\n  if (upgrade || method === 'CONNECT') {\n    if (typeof handler.onUpgrade !== 'function') {\n      throw new InvalidArgumentError('invalid onUpgrade method');\n    }\n  } else {\n    if (typeof handler.onHeaders !== 'function') {\n      throw new InvalidArgumentError('invalid onHeaders method');\n    }\n\n    if (typeof handler.onData !== 'function') {\n      throw new InvalidArgumentError('invalid onData method');\n    }\n\n    if (typeof handler.onComplete !== 'function') {\n      throw new InvalidArgumentError('invalid onComplete method');\n    }\n  }\n} // A body is disturbed if it has been read from and it cannot\n// be re-used without losing state or data.\n\n\nfunction isDisturbed(body) {\n  const state = body && body._readableState;\n  return !!(body && (stream.isDisturbed && stream.isDisturbed(body) || body[kBodyUsed] || body.readableDidRead || state && state.dataEmitted || isAborted(body)));\n}\n\nfunction getSocketInfo(socket) {\n  return {\n    localAddress: socket.localAddress,\n    localPort: socket.localPort,\n    remoteAddress: socket.remoteAddress,\n    remotePort: socket.remotePort,\n    remoteFamily: socket.remoteFamily,\n    timeout: socket.timeout,\n    bytesWritten: socket.bytesWritten,\n    bytesRead: socket.bytesRead\n  };\n}\n\nconst kEnumerableProperty = Object.create(null);\nkEnumerableProperty.enumerable = true;\nmodule.exports = {\n  kEnumerableProperty,\n  nop,\n  isDisturbed,\n  isAborted,\n  parseOrigin,\n  parseURL,\n  getServerName,\n  isStream,\n  isIterable,\n  isAsyncIterable,\n  isDestroyed,\n  parseHeaders,\n  parseKeepAliveTimeout,\n  destroy,\n  bodyLength,\n  deepClone,\n  isBuffer,\n  isBlob,\n  validateHandler,\n  getSocketInfo\n};","map":{"version":3,"sources":["/home/cameron/Dev/whoisWrapper/ui/node_modules/undici/lib/core/util.js"],"names":["assert","require","kDestroyed","kBodyUsed","IncomingMessage","stream","net","InvalidArgumentError","Blob","nop","isStream","obj","pipe","isBlob","parseURL","url","URL","port","Number","isFinite","parseInt","path","pathname","hostname","origin","test","protocol","search","parseOrigin","hash","getHostname","host","idx","indexOf","substr","getServerName","strictEqual","servername","isIP","deepClone","JSON","parse","stringify","isAsyncIterable","Symbol","asyncIterator","isIterable","iterator","bodyLength","body","state","_readableState","ended","length","size","isBuffer","byteLength","isDestroyed","destroyed","isAborted","endEmitted","destroy","err","Object","getPrototypeOf","constructor","socket","process","nextTick","emit","KEEPALIVE_TIMEOUT_EXPR","parseKeepAliveTimeout","val","m","toString","match","parseHeaders","headers","i","key","toLowerCase","Array","isArray","push","buffer","Uint8Array","Buffer","validateHandler","handler","method","upgrade","onConnect","onError","onBodySent","undefined","onUpgrade","onHeaders","onData","onComplete","isDisturbed","readableDidRead","dataEmitted","getSocketInfo","localAddress","localPort","remoteAddress","remotePort","remoteFamily","timeout","bytesWritten","bytesRead","kEnumerableProperty","create","enumerable","module","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nconst assert = require('assert')\nconst { kDestroyed, kBodyUsed } = require('./symbols')\nconst { IncomingMessage } = require('http')\nconst stream = require('stream')\nconst net = require('net')\nconst { InvalidArgumentError } = require('./errors')\nconst { Blob } = require('buffer')\n\nfunction nop () {}\n\nfunction isStream (obj) {\n  return obj && typeof obj.pipe === 'function'\n}\n\nfunction isBlob (obj) {\n  return obj && Blob && obj instanceof Blob\n}\n\nfunction parseURL (url) {\n  if (typeof url === 'string') {\n    url = new URL(url)\n  }\n\n  if (!url || typeof url !== 'object') {\n    throw new InvalidArgumentError('invalid url')\n  }\n\n  if (url.port != null && url.port !== '' && !Number.isFinite(parseInt(url.port))) {\n    throw new InvalidArgumentError('invalid port')\n  }\n\n  if (url.path != null && typeof url.path !== 'string') {\n    throw new InvalidArgumentError('invalid path')\n  }\n\n  if (url.pathname != null && typeof url.pathname !== 'string') {\n    throw new InvalidArgumentError('invalid pathname')\n  }\n\n  if (url.hostname != null && typeof url.hostname !== 'string') {\n    throw new InvalidArgumentError('invalid hostname')\n  }\n\n  if (url.origin != null && typeof url.origin !== 'string') {\n    throw new InvalidArgumentError('invalid origin')\n  }\n\n  if (!/^https?:/.test(url.origin || url.protocol)) {\n    throw new InvalidArgumentError('invalid protocol')\n  }\n\n  if (!(url instanceof URL)) {\n    const port = url.port != null\n      ? url.port\n      : (url.protocol === 'https:' ? 443 : 80)\n    const origin = url.origin != null\n      ? url.origin\n      : `${url.protocol}//${url.hostname}:${port}`\n    const path = url.path != null\n      ? url.path\n      : `${url.pathname || ''}${url.search || ''}`\n\n    url = new URL(path, origin)\n  }\n\n  return url\n}\n\nfunction parseOrigin (url) {\n  url = parseURL(url)\n\n  if (url.pathname !== '/' || url.search || url.hash) {\n    throw new InvalidArgumentError('invalid url')\n  }\n\n  return url\n}\n\nfunction getHostname (host) {\n  if (host[0] === '[') {\n    const idx = host.indexOf(']')\n\n    assert(idx !== -1)\n    return host.substr(1, idx - 1)\n  }\n\n  const idx = host.indexOf(':')\n  if (idx === -1) return host\n\n  return host.substr(0, idx)\n}\n\n// IP addresses are not valid server names per RFC6066\n// > Currently, the only server names supported are DNS hostnames\nfunction getServerName (host) {\n  if (!host) {\n    return null\n  }\n\n  assert.strictEqual(typeof host, 'string')\n\n  const servername = getHostname(host)\n  if (net.isIP(servername)) {\n    return ''\n  }\n\n  return servername\n}\n\nfunction deepClone (obj) {\n  return JSON.parse(JSON.stringify(obj))\n}\n\nfunction isAsyncIterable (obj) {\n  return !!(obj != null && typeof obj[Symbol.asyncIterator] === 'function')\n}\n\nfunction isIterable (obj) {\n  return !!(obj != null && (typeof obj[Symbol.iterator] === 'function' || typeof obj[Symbol.asyncIterator] === 'function'))\n}\n\nfunction bodyLength (body) {\n  if (body == null) {\n    return 0\n  } else if (isStream(body)) {\n    const state = body._readableState\n    return state && state.ended === true && Number.isFinite(state.length)\n      ? state.length\n      : null\n  } else if (isBlob(body)) {\n    return body.size\n  } else if (isBuffer(body)) {\n    return body.byteLength\n  }\n\n  return null\n}\n\nfunction isDestroyed (stream) {\n  return !stream || !!(stream.destroyed || stream[kDestroyed])\n}\n\nfunction isAborted (stream) {\n  const state = stream && stream._readableState\n  return isDestroyed(stream) && state && !state.endEmitted\n}\n\nfunction destroy (stream, err) {\n  if (!isStream(stream) || isDestroyed(stream)) {\n    return\n  }\n\n  if (typeof stream.destroy === 'function') {\n    if (Object.getPrototypeOf(stream).constructor === IncomingMessage) {\n      // See: https://github.com/nodejs/node/pull/38505/files\n      stream.socket = null\n    }\n    stream.destroy(err)\n  } else if (err) {\n    process.nextTick((stream, err) => {\n      stream.emit('error', err)\n    }, stream, err)\n  }\n\n  if (stream.destroyed !== true) {\n    stream[kDestroyed] = true\n  }\n}\n\nconst KEEPALIVE_TIMEOUT_EXPR = /timeout=(\\d+)/\nfunction parseKeepAliveTimeout (val) {\n  const m = val.toString().match(KEEPALIVE_TIMEOUT_EXPR)\n  return m ? parseInt(m[1], 10) * 1000 : null\n}\n\nfunction parseHeaders (headers, obj = {}) {\n  for (let i = 0; i < headers.length; i += 2) {\n    const key = headers[i].toString().toLowerCase()\n    let val = obj[key]\n    if (!val) {\n      obj[key] = headers[i + 1].toString()\n    } else {\n      if (!Array.isArray(val)) {\n        val = [val]\n        obj[key] = val\n      }\n      val.push(headers[i + 1].toString())\n    }\n  }\n  return obj\n}\n\nfunction isBuffer (buffer) {\n  // See, https://github.com/mcollina/undici/pull/319\n  return buffer instanceof Uint8Array || Buffer.isBuffer(buffer)\n}\n\nfunction validateHandler (handler, method, upgrade) {\n  if (!handler || typeof handler !== 'object') {\n    throw new InvalidArgumentError('handler must be an object')\n  }\n\n  if (typeof handler.onConnect !== 'function') {\n    throw new InvalidArgumentError('invalid onConnect method')\n  }\n\n  if (typeof handler.onError !== 'function') {\n    throw new InvalidArgumentError('invalid onError method')\n  }\n\n  if (typeof handler.onBodySent !== 'function' && handler.onBodySent !== undefined) {\n    throw new InvalidArgumentError('invalid onBodySent method')\n  }\n\n  if (upgrade || method === 'CONNECT') {\n    if (typeof handler.onUpgrade !== 'function') {\n      throw new InvalidArgumentError('invalid onUpgrade method')\n    }\n  } else {\n    if (typeof handler.onHeaders !== 'function') {\n      throw new InvalidArgumentError('invalid onHeaders method')\n    }\n\n    if (typeof handler.onData !== 'function') {\n      throw new InvalidArgumentError('invalid onData method')\n    }\n\n    if (typeof handler.onComplete !== 'function') {\n      throw new InvalidArgumentError('invalid onComplete method')\n    }\n  }\n}\n\n// A body is disturbed if it has been read from and it cannot\n// be re-used without losing state or data.\nfunction isDisturbed (body) {\n  const state = body && body._readableState\n  return !!(body && (\n    (stream.isDisturbed && stream.isDisturbed(body)) ||\n    body[kBodyUsed] ||\n    body.readableDidRead || (state && state.dataEmitted) ||\n    isAborted(body)\n  ))\n}\n\nfunction getSocketInfo (socket) {\n  return {\n    localAddress: socket.localAddress,\n    localPort: socket.localPort,\n    remoteAddress: socket.remoteAddress,\n    remotePort: socket.remotePort,\n    remoteFamily: socket.remoteFamily,\n    timeout: socket.timeout,\n    bytesWritten: socket.bytesWritten,\n    bytesRead: socket.bytesRead\n  }\n}\n\nconst kEnumerableProperty = Object.create(null)\nkEnumerableProperty.enumerable = true\n\nmodule.exports = {\n  kEnumerableProperty,\n  nop,\n  isDisturbed,\n  isAborted,\n  parseOrigin,\n  parseURL,\n  getServerName,\n  isStream,\n  isIterable,\n  isAsyncIterable,\n  isDestroyed,\n  parseHeaders,\n  parseKeepAliveTimeout,\n  destroy,\n  bodyLength,\n  deepClone,\n  isBuffer,\n  isBlob,\n  validateHandler,\n  getSocketInfo\n}\n"]},"metadata":{},"sourceType":"script"}